#!/bin/sh

set -e

# shellcheck source=../share/replicator/_lib.sh
. "${XDG_DATA_HOME:-$HOME/.local/share}/replicator/_lib.sh"

SCRIPTS="$XDG_DATA_HOME/replicator"

cat=${1:-all}

case $cat in
  all)
    for script in "$SCRIPTS"/*; do
      case "$script" in */_lib.sh) continue ;; esac
      [ -x "$script" ] && "$script"
    done
    ;;
  list)
    find "$SCRIPTS" -type f -executable -exec basename {} \; | sort | sed 's/^[0-9]\{2\}_//; s/\.sh$//'
    ;;
  *)
    script=$(find "$SCRIPTS" -type f -executable -iname "??_${cat}.sh")
    if [ -n "$script" ]; then
      exec "$script"
    else
      echo "$script does not exist!"
      exit 1
    fi
    ;;
esac
