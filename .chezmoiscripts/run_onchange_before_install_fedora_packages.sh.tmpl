{{- if hasKey .chezmoi.osRelease "idLike" -}}
{{- if eq .chezmoi.osRelease.idLike "fedora" -}}
#!/bin/sh -e

echo "Asking for root credentials..."
sudo -v

if ! [ -f "/etc/yum.repos.d/github-cli.repo" ]; then
  echo "Enabling github-cli repo..."

  sudo tee "/etc/yum.repos.d/github-cli.repo" <<EOF >/dev/null
[github-cli]
enabled=1
name=packages for the GitHub CLI
baseurl=https://cli.github.com/packages/rpm
gpgkey=file://{{ joinPath .chezmoi.sourceDir ".keyring" "github-cli.asc" }}
EOF
fi

echo "Installing packages with DNF..."
sudo dnf group install -y "C Development Tools and Libraries" "Development Tools" "Development Libraries"
sudo dnf install --skip-broken -y \
  {{/* Development Tools */ -}}
  ccache \
  clang \
  cmake \
  musl-clang \
  musl-gcc \
  {{/* Libraries */ -}}
  bzip2-devel \
  gdbm-devel \
  gmp-devel \
  libffi-devel \
  libyaml-devel \
  ncurses-devel \
  openssl-devel \
  readline-devel \
  sqlite-devel \
  xz-devel \
  zlib-devel \
  {{/* User Programs */ -}}
  age \
  asciinema \
  bat \
  bcc-tools \
  ctags \
  direnv \
  exa \
  fd-find \
  fish \
  fzf \
  gdb \
  gh \
  git \
  git-delta \
  git-filter-repo \
  git-lfs \
  golang \
  hexyl \
  htop \
  hyperfine \
  jq \
  lftp \
  lsof \
  ltrace \
  man-pages \
  mosh \
  mycli \
  neovim \
  net-tools \
  pcp-system-tools \
  perf \
  perl-File-MimeInfo \
  ShellCheck \
  pgcli \
  pipx \
  pre-commit \
  ripgrep \
  rr \
  sd \
  socat \
  starship \
  tealdeer \
  thefuck \
  tig \
  tmate \
  tmux \
  tokei \
  unzip \
  whois \
  xdg-utils \
  zoxide

# Missing:
# 1password-cli
# chezmoi
# croc
# curlie
# diskus
# git-interactive-rebase-tool
# mkcert
# vivid
# watchexec

# vi: ft=sh
{{- end -}}
{{- end -}}
