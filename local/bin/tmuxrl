#!/bin/sh

pane="$1"
op="$2"
full="$3"

tmux capture-pane -J ${full:+-S- -E-} ${pane:+-t $pane} -p | xurls | fzf-tmux -d 25% --tac -1 -m --prompt="$op: " | while read -r url; do
  if [ "${op:-open}" = "open" ]; then
    case $(uname) in
      Darwin)
        open "$url"
        ;;
      *)
        xdg-open "$url"
        ;;
    esac
  else
    echo "$url" | yankee
  fi
done

