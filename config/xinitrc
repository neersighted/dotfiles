#!/usr/bin/env bash

# Default to dwm.
export DESKTOP_SESSION=${1:-dwm}

# Load profile.
for f in "/etc/profile" "$HOME/.profile" "/etc/xprofile" "$HOME/.xprofile"; do
  [ -f "$f" ] && . "$f"
done

# Load resources.
for f in "/etc/X11/Xresources" "$HOME/.Xresources"; do
  [ -f "$f" ] && xrdb -merge "$f"
done

# Load keymaps.
for f in "/etc/X11/Xkbmap" "$HOME/.Xkbmap"; do
  [ -f "$file" ] && setxkbmap < "$f" && XKB=1
done
# Load xmodmap if not using keymaps.
if [ ! "$XKB" -eq 1 ]; then
  for f in "/etc/X11/Xmodmap" "$HOME/.Xmodmap"; do
    [ -f "$f" ] && xmodmap "$f"
  done
fi
unset XKB

# Load global config.
if [ -d /etc/X11/xinit/xinitrc.d ] ; then
 for f in /etc/X11/xinit/xinitrc.d/?*.sh ; do
  [ -x "$f" ] && . "$f"
 done
fi

# Load user config.
for f in "$HOME/.xsession" "$HOME/.xsession.local"; do
  [ -f "$file" ] && . "$f"
done

case $DESKTOP_SESSION in
    dwm) exec dwm;;
    i3 ) exec i3;;
    *  ) exec $DESKTOP_SESSION;;
esac
