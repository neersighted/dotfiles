{{- if hasKey .chezmoi.osRelease "idLike" -}}
{{- if eq .chezmoi.osRelease.idLike "debian" -}}
#!/bin/sh -e

{{ if eq .chezmoi.osRelease.id "ubuntu" -}}
echo "Adding custom Ubuntu repos..."
sudo apt-add-repository --yes --no-update ppa:fish-shell/release-3 # FIXME: new syntax is --ppa
{{ end -}}

# FIXME: codespaces special-casing
echo "Installing packages with APT..."
sudo apt-get update
sudo apt-get install -y \
  {{/* Development Tools */ -}}
  build-essential \
  ccache \
  clang \
  cmake \
  musl-tools \
  pkgconf \
  {{/* Libraries */ -}}
  libbz2-dev \
  libffi-dev \
  libgdbm-dev \
  libgmp-dev \
  liblzma-dev \
  libncurses-dev \
  libreadline-dev \
  libsqlite3-dev \
  libssl-dev \
  libyaml-dev \
  zlib1g-dev \
  {{/* User Programs */ -}}
  age \
  asciinema \
  bat \
  bpfcc-tools \
  direnv \
{{- if not .codespaces }}
  exa \
{{- end }}
  fd-find \
  fish \
  fzf \
  gdb \
  git \
{{- if not .codespaces }}
  git-filter-repo \
{{- end }}
  git-lfs \
  golang \
  hexyl \
  htop \
  jq \
  lftp \
  libfile-mimeinfo-perl \
  linux-tools-common \
  manpages-posix \
  manpages-posix-dev \
  mosh \
  mycli \
  neovim \
  pcp \
  pgcli \
  pipx \
{{- if not .codespaces }}
  pre-commit \
{{- end }}
  python-is-python3 \
  ripgrep \
{{- if eq .chezmoi.arch "amd64" }}
  rr \
{{- end }}
  shellcheck \
  socat \
  thefuck \
  tig \
  tmux \
  universal-ctags \
  unzip \
  whois \
  xdg-utils \
{{- if not .codespaces }}
  zoxide
{{ else }}
  ""
{{- end }}

# Missing:
# 1password-cli
# croc
# curlie
# diskus
# git-delta-bin
# git-interactive-rebase-tool
# gh
# hyperfine
# lostfiles
# mkcert
# sd
# tealdeer
# tokei
# vivid
# watchexec

# vi: ft=sh
{{- end -}}
{{- end -}}
